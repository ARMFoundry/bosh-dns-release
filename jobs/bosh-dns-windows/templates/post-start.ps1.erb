$ErrorActionPreference = "Stop"

$address = "<%= p('address', spec.ip) == "0.0.0.0" ? "127.0.0.1" : p('address', spec.ip) %>"

try
{
    Resolve-DnsName -DnsOnly -Name upcheck.bosh-dns. -Server $address
    Resolve-DnsName -TcpOnly -DnsOnly -Name upcheck.bosh-dns. -Server $address
}
catch
{
    $Host.UI.WriteErrorLine($_.Exception.Message)
    Exit 1
}
Exit 0
